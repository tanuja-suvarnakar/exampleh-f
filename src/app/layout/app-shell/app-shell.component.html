<!-- src/app/layout/app-shell/app-shell.component.html -->
<div class="app-shell" (click)="closeDropdowns()">
  
  <!-- Sidebar -->
  <aside 
    class="sidebar"
    [class.collapsed]="sidebarCollapsed"
  >
    <!-- Logo Section -->
    <div class="sidebar-header">
      <div class="logo-wrapper">
        <div class="logo">
          <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="40" height="40" rx="12" fill="url(#logo-gradient)"/>
            <path d="M12 20h16M20 12v16M14 14l12 12M26 14L14 26" stroke="white" stroke-width="2" stroke-linecap="round"/>
            <defs>
              <linearGradient id="logo-gradient" x1="0" y1="0" x2="40" y2="40">
                <stop stop-color="#6366F1"/>
                <stop offset="1" stop-color="#8B5CF6"/>
              </linearGradient>
            </defs>
          </svg>
        </div>
        <div class="logo-text" *ngIf="!sidebarCollapsed">
          <span class="brand-name">ExamplehConnect</span>
          <span class="brand-tagline">Exampleh CRM</span>
        </div>
      </div>
      <button 
        class="collapse-btn"
        (click)="toggleSidebar(); $event.stopPropagation()"
        [attr.aria-label]="sidebarCollapsed ? 'Expand sidebar' : 'Collapse sidebar'"
      >
        <svg 
          class="collapse-icon" 
          [class.rotated]="sidebarCollapsed"
          viewBox="0 0 24 24" 
          fill="none" 
          stroke="currentColor" 
          stroke-width="2"
        >
          <path d="M15 18l-6-6 6-6"/>
        </svg>
      </button>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions" *ngIf="!sidebarCollapsed">
      <button class="quick-action-btn primary" routerLink="/app/exampleps/new">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14M5 12h14"/>
        </svg>
        <span>New Examplep</span>
      </button>
    </div>

    <!-- Navigation -->
    <nav class="nav-container">
      <div class="nav-group" *ngFor="let group of navigation">
        <div class="nav-group-title" *ngIf="!sidebarCollapsed">
          {{ group.title }}
        </div>
        <div class="nav-divider" *ngIf="sidebarCollapsed"></div>
        
        <ng-container *ngFor="let item of group.items">
          <a
            *ngIf="canAccess(item)"
            [routerLink]="item.route"
            routerLinkActive="active"
            [routerLinkActiveOptions]="{ exact: item.exact || false }"
            class="nav-item"
            [class.collapsed]="sidebarCollapsed"
            [attr.title]="sidebarCollapsed ? item.label : null"
          >
            <div class="nav-icon">
              <ng-container [ngSwitch]="item.icon">
                <!-- Dashboard Icon -->
                <svg *ngSwitchCase="'dashboard'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="3" y="3" width="7" height="7" rx="1"/>
                  <rect x="14" y="3" width="7" height="7" rx="1"/>
                  <rect x="3" y="14" width="7" height="7" rx="1"/>
                  <rect x="14" y="14" width="7" height="7" rx="1"/>
                </svg>
                
                <!-- Exampleps Icon -->
                <svg *ngSwitchCase="'patients'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <circle cx="12" cy="8" r="4"/>
                  <path d="M4 20c0-4 4-6 8-6s8 2 8 6"/>
                </svg>
                
                <!-- Calendar/Visits Icon -->
                <svg *ngSwitchCase="'calendar'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="3" y="4" width="18" height="18" rx="2"/>
                  <path d="M16 2v4M8 2v4M3 10h18"/>
                  <circle cx="12" cy="15" r="1.5"/>
                </svg>
                
                <!-- Examplepres Icon -->
                <svg *ngSwitchCase="'prescription'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M9 3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-4"/>
                  <path d="M9 3v4a2 2 0 002 2h4"/>
                  <path d="M14 11l-5 5M14 16l-5-5"/>
                </svg>
                
                <!-- Users Icon -->
                <svg *ngSwitchCase="'users'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <circle cx="9" cy="7" r="3"/>
                  <circle cx="17" cy="7" r="3"/>
                  <path d="M3 18c0-3 3-5 6-5s6 2 6 5"/>
                  <path d="M15 13c3 0 6 2 6 5"/>
                </svg>
              </ng-container>
            </div>
            
            <span class="nav-label" *ngIf="!sidebarCollapsed">{{ item.label }}</span>
            
            <span 
              class="nav-badge" 
              *ngIf="item.badge && !sidebarCollapsed"
            >
              {{ item.badge }}
            </span>
            
            <span 
              class="nav-badge-dot" 
              *ngIf="item.badge && sidebarCollapsed"
            ></span>
          </a>
        </ng-container>
      </div>
    </nav>

    <!-- Sidebar Footer -->
    <div class="sidebar-footer">
      <div class="status-indicator" *ngIf="!sidebarCollapsed">
        <span class="status-dot online"></span>
        <span class="status-text">System Online</span>
      </div>
      
      <div class="user-mini-profile" *ngIf="!sidebarCollapsed">
        <div class="user-avatar gradient">
          {{ getUserInitials() }}
        </div>
        <div class="user-info">
          <span class="user-name">{{ user?.fullName || 'User' }}</span>
          <span class="user-role">{{ user?.role === 'ADMIN' ? 'Administrator' : user?.role === 'EXAMPLED' ? 'Exampled' : user?.role }}</span>
        </div>
        <button class="logout-btn" (click)="logout(); $event.stopPropagation()" title="Sign out">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/>
          </svg>
        </button>
      </div>
      
      <div class="collapsed-avatar" *ngIf="sidebarCollapsed">
        <div class="user-avatar gradient small">
          {{ getUserInitials() }}
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Content Area -->
  <div class="main-area">
    
    <!-- Top Header -->
    <header class="top-header">
      <div class="header-left">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-btn" (click)="toggleSidebar(); $event.stopPropagation()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
          </svg>
        </button>
        
        <!-- Breadcrumb / Page Title -->
        <div class="page-header">
          <h1 class="page-title">Exampleh Workspace</h1>
          <div class="breadcrumb">
            <span>Operations CRM</span>
          </div>
        </div>
      </div>

      <div class="header-right">
        <!-- Global Search -->
        <div class="search-box">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35"/>
          </svg>
          <input type="text" placeholder="Search exampleps, records..." />
          <kbd class="search-shortcut">âŒ˜K</kbd>
        </div>

        <!-- Date/Time Display -->
        <div class="datetime-display">
          <span class="date">{{ currentTime | date:'EEE, MMM d' }}</span>
          <span class="time">{{ currentTime | date:'h:mm a' }}</span>
        </div>

        <!-- Notifications -->
        <div class="notification-wrapper" (click)="$event.stopPropagation()">
          <button 
            class="icon-btn notification-btn"
            [class.has-notifications]="getUnreadCount() > 0"
            (click)="toggleNotifications()"
          >
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/>
            </svg>
            <span class="notification-count" *ngIf="getUnreadCount() > 0">
              {{ getUnreadCount() }}
            </span>
          </button>
          
          <!-- Notifications Dropdown -->
          <div class="dropdown notifications-dropdown" *ngIf="showNotifications">
            <div class="dropdown-header">
              <h3>Notifications</h3>
              <button class="mark-read-btn">Mark all read</button>
            </div>
            <div class="dropdown-content">
              <div 
                class="notification-item" 
                *ngFor="let notif of notifications"
                [class.unread]="!notif.read"
              >
                <div class="notif-indicator"></div>
                <div class="notif-content">
                  <span class="notif-title">{{ notif.title }}</span>
                  <span class="notif-time">{{ notif.time }}</span>
                </div>
              </div>
            </div>
            <div class="dropdown-footer">
              <a href="#">View all notifications</a>
            </div>
          </div>
        </div>

        <!-- User Menu -->
        <div class="user-menu-wrapper" (click)="$event.stopPropagation()">
          <button class="user-menu-btn" (click)="toggleUserMenu()">
            <div class="user-avatar gradient">
              {{ getUserInitials() }}
            </div>
           
            <svg 
              class="chevron" 
              [class.rotated]="showUserMenu"
              viewBox="0 0 24 24" 
              fill="none" 
              stroke="currentColor" 
              stroke-width="2"
            >
              <path d="M6 9l6 6 6-6"/>
            </svg>
          </button>
          
          <!-- User Dropdown -->
          <div class="dropdown user-dropdown" *ngIf="showUserMenu">
            <div class="dropdown-header user-header">
              <div class="user-avatar gradient large">
                {{ getUserInitials() }}
              </div>
              <div class="user-full-info">
                <span class="name">{{ user?.fullName }}</span>
                <span class="email">{{ user?.email || 'user@example.com' }}</span>
              </div>
            </div>
            <div class="dropdown-content">
              <a class="dropdown-item" routerLink="/app/profile">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="8" r="4"/>
                  <path d="M4 20c0-4 4-6 8-6s8 2 8 6"/>
                </svg>
                My Profile
              </a>
              <a class="dropdown-item" routerLink="/app/settings">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="3"/>
                  <path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/>
                </svg>
                Settings
              </a>
            </div>
            <div class="dropdown-footer">
              <button class="logout-item" (click)="logout()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/>
                </svg>
                Sign out
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="page-content">
      <div class="content-wrapper">
        <router-outlet></router-outlet>
      </div>
    </main>

  </div>
</div>